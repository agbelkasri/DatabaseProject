<!DOCTYPE html>
<html lang="en-us">


<body style = "background-color: lavender">

<style>
.century {
	font-family: "Century Gothic";
}


body, html {
    height: 100%;
    margin: 0;
}

.hero-text {
  text-align: center;
  color: black;
}

.hero-text button {
  border: none;
  outline: 0;
  display: inline-block;
  padding: 10px 25px;
  color: black;
  background-color: #ddd;
  text-align: center;
  cursor: pointer;
}

.hero-text button:hover {
  background-color: #555;
  color: white;

}


</style>


<head>
  
  <title>Database</title>
  <meta charset="UTF-8">
  
  <!-- jQuery link -->
  <script
    src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js">
  </script>  

  <!-- Declare and store seats array -->
  <script type="text/javascript">
    "use strict";
    
    // Declare arrays
    var events;
    var seats;

    //================================================================
    // loadEvents
    //================================================================
    function loadEvents()
    {
      $(function()
      {    
        var queryString = "request=get";
        $.getJSON(
          "CrislerArena-Events.json", 
          queryString, 
          loadEventsResponse);
      });
    }
    
    //================================================================
    // loadEventsResponse
    //================================================================
    function loadEventsResponse(data, status)
    {
      events = data;
      console.log("Events data retrieved.");
      setSeats();
    }

    //================================================================
    // loadSeats
    //================================================================
    function loadSeats()
    {
      $(function()
      {    
        var queryString = "request=get";
        $.getJSON(
          "CrislerArena-Seats.json", 
          queryString, 
          loadSeatsResponse);
      });
    }
    
    //================================================================
    // loadSeatsResponse
    //================================================================
    function loadSeatsResponse(data, status)
    {
      seats = data;
      console.log("Seats data retrieved.");
      loadEvents();
    }

    //================================================================
    // seatTypeSelected
    //================================================================
    function seatTypeSelected()
    {
      
      // Get seat cost
      var selection = 
        document.querySelector('input[name="rgSeatType"]:checked').value;
      var index = 0;
      while (index < seats.length && seats[index][0] != selection)
        index = index + 1;

      // Declare variables
      var seatCost = seats[index][1];
      var subtotal = txtTickets.value * seatCost;
      var tax = subtotal * 0.06;
      var total = subtotal + tax;
      
      // Set text boxes
      txtSeatCost.value = seatCost.toFixed(2);
      txtSubtotal.value = subtotal.toFixed(2);
      txtTax.value = tax.toFixed(2);
      txtTotal.value = total.toFixed(2);
     
      console.log("Radio button " + selection + 
        " (" + index + ") selected.");
        
    }

    //================================================================
    // setEvents
    //================================================================
    function setEvents()
    {
    
      // Declare variables
      var i;
      var op;
      var tx;

      // Loop through events array to build combo box
      for (i = 0; i < events.length; i++)
      {
              
        // Create option and add to combo box
        op = document.createElement("option");
        op.setAttribute("value", events[i][0]);
        tx = document.createTextNode(events[i][0]);
        op.appendChild(tx);                                
        cmbEvent.appendChild(op);
        console.log("Option '" + events[i][0] + ", " + 
          events[i][1] + "' added.");

      }
      console.log("Events combo box set.");
      seatTypeSelected();
        
    }

    //================================================================
    // setSeats
    //================================================================
    function setSeats()
    {

      // Declare variables
      var i;
      var inp;
      var tx;

      // Loop through events array to build combo box
      for (i = 0; i < seats.length; i++)
      {
              
        // Create radio button and add to radio group
        inp = document.createElement("input");
        inp.setAttribute("type", "radio");
        inp.setAttribute("name", "rgSeatType");
        inp.setAttribute("value", seats[i][0]);
        inp.setAttribute("onchange", "seatTypeSelected()");
        if (i == 0)
          inp.setAttribute("checked", true);
        divSeatType.appendChild(inp);
        tx = document.createTextNode(seats[i][0]);
        divSeatType.appendChild(tx);                                
        inp = document.createElement("br");
        divSeatType.appendChild(inp);                                
        console.log("Radio button '" + seats[i][0] + ", " + 
          seats[i][1] + "' added.");

      }
      console.log("Seat radio buttons set.");
      setEvents();
        
    }

    function updateTicketSales()
    {
      $(function()
      {    
        var queryString = "request=add";
        $.getJSON(
          "CrislerArena-Seats.json", 
          queryString, 
          loadSeatsResponse);
      });
    }

  </script>
  
</head>
 
<body onload="loadSeats()">

  <!-- Menu section -->
  <div class="menuPanel">
    <h2>
    	<a href="index.html">Home</a>
     	<a href="authorspage.html">Authors</a>
    </h2>
  </div>
  <hr>
  
  <!-- Left panel -->
  <div class="contentPanel3">
  
    <!-- Form -->
    <form 
      method="get" 
      enctype="application/x-www-form-urlencoded"
      action="CrislerArena-TicketsConfirmation.php" 
      action="DatabaseInterface.php"
      >

      <!-- Customer name and e-mail -->
      <label>Task Description:</label>
      <input type="text" name="txtCustomerName" required>
      <br><br>
      <label>Take Category:</label>
      <input type="email" name="txtCustomerEmail" required>
      <br><br>

      <!-- Event name and date -->
      <label>Status:</label>
      <select id="cmbEvent" name="cmbEvent">
      </select> 
      <br><br>
      
      <label>Due Date:</label>
      <input type="date" name="txtDate" value="2021-05-10" required>
      <br><br>

      <!-- Ticket count -->
      <label>Priority Level (1-4):</label>
      <input 
        type="number" name="txtTickets" id="txtTickets" value="2" 
        min="1" step="1" max="4" required
        onchange="seatTypeSelected()" 
        >
      <br><br>

      <!-- Form buttons -->
      <input type="submit" value="Submit" class="formButton" onsubmit="updateTicketSales()" >
      <input type="reset" value="Reset" class="formButton">

    </form>

  </div>

  <!-- Right panel -->
  <div class="contentPanel3">
  
</body>
 
</html>
